<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rolph Population Sandbox</title>
  <style>
    :root{
      --pink:#ec4899; --bg:#0b0f14; --fg:#e5e7eb; --muted:#94a3b8; --card:#111827; --accent:#334155;
      --topH:264px; --bottomH:156px;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:var(--bg); color:var(--fg)}
    .wrap{max-width:1100px; margin:24px auto; padding:0 16px}
    h1{font-size:22px; margin:0 0 12px; font-weight:600}

    .grid{display:grid; gap:12px}
    @media(min-width:900px){ .grid.cols-4{grid-template-columns:repeat(4,1fr);} }

    .card{background:var(--card); border:1px solid var(--accent); border-radius:16px; box-shadow:0 1px 4px rgba(0,0,0,.25); display:flex; flex-direction:column}
    .card h2{margin:0; padding:14px 16px; font-size:16px; border-bottom:1px solid var(--accent)}
    .content{padding:14px 16px; flex:1}

    .top-cards .card{height:var(--topH)}
    .bottom-cards .card{height:var(--bottomH)}
    .card .content{overflow:hidden}
    .content.scrollable{overflow:auto}

    label{font-size:12px; color:var(--muted); display:block; margin-bottom:4px}
    input[type=number]{width:100%; padding:8px 10px; border-radius:10px; border:1px solid var(--accent); background:#0b1220; color:var(--fg)}
    input[type=range]{width:100%}
    input[type=checkbox]{transform:scale(1.1)}
    .row{display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-bottom:8px}
    .muted{color:var(--muted); font-size:11px}
    .welcome{color:var(--fg); font-size:11px; line-height:1.35}

    .chart{height:min(40vh, 480px); width:100%; position:relative}
    .chart canvas{display:block; width:100%; height:100%}
    .tt{position:absolute; pointer-events:none; display:none; padding:6px 8px; font-size:12px; color:var(--fg); background:#0b1220; border:1px solid var(--accent); border-radius:8px; transform:translate(10px, -120%); white-space:nowrap}

    .bigyear{font-size:28px; font-weight:800; text-align:center}
    .prehuman{color:#f87171}
    .health{font-size:28px; font-weight:800; text-align:center}
    .health-ok{color:#34d399} .health-med{color:#fbbf24} .health-caution{color:#f59e0b} .health-warn{color:#ef4444} .health-dead{color:#ef4444}

    /* header with selector */
    .title-row{display:flex; align-items:center; justify-content:space-between; gap:8px}
    .title-row .right{display:flex; align-items:center; gap:6px}
    .select{background:#0b1220; color:var(--fg); border:1px solid var(--accent); border-radius:10px; padding:4px 8px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Rolph Population Sandbox</h1>

    <div class="grid cols-4 top-cards">
      <div class="card">
        <h2>Population & Timeline</h2>
        <div class="content scrollable">
          <div class="row">
            <div><label>Start population</label><input id="startPop" type="number" value="400"></div>
            <div><label>Start mean age</label><input id="startMeanAge" type="number" value="10"></div>
            <div style="grid-column:1 / span 2">
              <label>Years to simulate</label>
              <input id="years" type="number" value="100000">
              <input id="yearsRange" type="range" min="10" max="100000" step="10" value="100000" style="margin-top:6px">
              <div class="muted">Up to 100,000. Slider syncs with the number box; internal sampling keeps the chart responsive.</div>
            </div>
            <div class="row" style="grid-template-columns:auto 1fr; align-items:center">
              <div><input id="logScale" type="checkbox"></div>
              <label for="logScale" style="margin:0">Log scale (min=1)</label>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2>Mortality</h2>
        <div class="content">
          <div class="row">
            <div><label>Mean life (years)</label><input id="meanLife" type="number" step="0.1" value="10"></div>
            <div><label>Max age</label><input id="maxAge" type="number" value="80"></div>
            <div><label>Survive to 40 (1 in N)</label><input id="survive40Denom" type="number" value="180"><div class="muted">≈ <span id="s40Pct">0.556</span>%</div></div>
            <div><label>Survive to max age (1 in N)</label><input id="surviveMaxDenom" type="number" value="1000"><div class="muted">≈ <span id="smaxPct">0.100</span>%</div></div>
          </div>
          <div class="muted">Checks: S(40)=<span id="checkS40">—</span>% · S(<span id="checkMaxAge">80</span>)=<span id="checkSMax">—</span>% · mean≈<span id="checkMean">—</span>y</div>
        </div>
      </div>

      <div class="card">
        <h2>Fertility</h2>
        <div class="content">
          <div class="row">
            <div><label>Birthing age start</label><input id="fertileStart" type="number" value="9"></div>
            <div><label>Birthing age stop</label><input id="fertileEnd" type="number" value="35"></div>
            <div style="grid-column:1 / span 2"><label>Average kids per girl</label><input id="kidsPerGirl" type="number" step="0.01" value="12.2">
              <div class="muted">Window=<span id="fertYears">27</span>y · births per fertile girl≈<span id="birthsPerYear">0.452</span>/yr</div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2>Catastrophic event</h2>
        <div class="content">
          <div class="row">
            <div class="row" style="grid-template-columns:auto 1fr; align-items:center"><div><input id="catEnabled" type="checkbox"></div><label for="catEnabled" style="margin:0">Enabled</label></div>
            <div><label>Every N years</label><input id="catPeriod" type="number" value="200"></div>
            <div><label>Kill fraction (%)</label><input id="catKillPct" type="number" value="70"></div>
            <div><label>Starts at year</label><input id="catStart" type="number" value="200"></div>
          </div>
          <div class="muted">Applied at end of the year (after births & natural deaths) by removing a fraction across all ages.</div>
        </div>
      </div>
    </div>

    <div class="grid cols-4 bottom-cards" style="margin-top:12px">
      <div class="card">
        <h2>Start year</h2>
        <div class="content"><div id="startYearBig" class="bigyear">—</div></div>
      </div>
      <div class="card">
        <h2>Population health</h2>
        <div class="content"><div id="healthLabel" class="health">—</div><div id="healthDetail" class="muted" style="text-align:center; margin-top:6px">—</div></div>
      </div>
      <div class="card">
        <h2>Reset</h2>
        <div class="content"><button id="resetBtn" class="btn" style="padding:8px 12px; border-radius:10px; background:#0f172a; color:var(--fg); border:1px solid var(--accent); cursor:pointer">Reset to defaults</button></div>
      </div>
      <div class="card">
        <h2>Welcome</h2>
        <div class="content welcome">
          <div>Welcome to <b>Rolph population simulator</b>.</div>
          <div style="margin-top:6px">Simulate population growth over any given time period.</div>
          <div style="margin-top:6px">Try to keep growth within a <b>healthy target</b>.</div>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <h2 class="title-row">
        <span>Population over time</span>
        <span class="right muted">Max
          <select id="yMaxSelect" class="select">
            <option value="100000" selected>100k</option>
            <option value="1000000">1M</option>
            <option value="1000000000">1B</option>
          </select>
        </span>
      </h2>
      <div class="content">
        <div class="chart"><canvas id="chart"></canvas><div id="tooltip" class="tt"></div></div>
        <div class="muted" style="margin-top:6px">Linear Y‑axis: −100,000 .. selected max (chooser in header). Toggle log if the line hugs the floor. Hover for Year, Pop, plus B/D this year and totals.</div>
      </div>
    </div>
  </div>

<script>
const DEBOUNCE_MS=160;
function clamp(x,a,b){return Math.max(a,Math.min(b,x));}
function abbr(n){const a=Math.abs(n);if(a>=1e12)return(n/1e12).toFixed(2).replace(/\.00$/,'')+'T';if(a>=1e9)return(n/1e9).toFixed(2).replace(/\.00$/,'')+'B';if(a>=1e6)return(n/1e6).toFixed(2).replace(/\.00$/,'')+'M';if(a>=1e3)return(n/1e3).toFixed(2).replace(/\.00$/,'')+'k';return String(Math.round(n));}

const START_YEAR=2025; const AGE_TO_YEARS_AGO=[{age:8,yrsAgo:1_000_000},{age:9,yrsAgo:100_000},{age:12,yrsAgo:10_000},{age:15,yrsAgo:1_000},{age:17,yrsAgo:0}];
function interpYearsAgoFromAge(age){if(age<8)return{yrsAgo:Infinity,preHuman:true};if(age>=17)return{yrsAgo:0,preHuman:false};for(let i=0;i<AGE_TO_YEARS_AGO.length-1;i++){const a0=AGE_TO_YEARS_AGO[i],a1=AGE_TO_YEARS_AGO[i+1];if(age>=a0.age&&age<=a1.age){const t=(age-a0.age)/(a1.age-a0.age);const yrs=a0.yrsAgo+t*(a1.yrsAgo-a0.yrsAgo);return{yrsAgo:Math.max(0,yrs),preHuman:false}}}return{yrsAgo:0,preHuman:false}}
function formatYearFromYearsAgo(yrsAgo){if(!isFinite(yrsAgo))return'PRE‑HUMAN';const yrs=Math.max(0,yrsAgo);const ce=START_YEAR-yrs;if(ce>=1)return String(Math.round(ce));const bce=Math.max(1,Math.round(yrs-(START_YEAR-1)));return bce.toLocaleString()+' BCE'}

function truncatedGeomWeights(p,K){const w=new Float64Array(K+1);let s=0;for(let k=0;k<=K;k++){const v=p*Math.pow(1-p,k);w[k]=v;s+=v}for(let k=0;k<=K;k++)w[k]/=s;return w}
function truncatedGeomMean(p,K){const w=truncatedGeomWeights(p,K);let m=0;for(let k=0;k<=K;k++)m+=w[k]*k;return m}
function solvePForTruncMean(target,K){let lo=1e-9,hi=0.999999;const maxMean=K/2;const t=clamp(target,0,maxMean);for(let i=0;i<120;i++){const mid=(lo+hi)/2;const m=truncatedGeomMean(mid,K);if(Math.abs(m-t)<1e-9)return mid;if(m>t)lo=mid;else hi=mid}return(lo+hi)/2}
function buildLifeTable(meanLife,S40,Smax,maxAge){const K=39;const pmfMax=Smax;const pmf40=Math.max(0,S40-Smax);const massPre40=Math.max(0,1-(pmf40+pmfMax));const targetMeanPre40=(meanLife-(pmf40*40+pmfMax*maxAge))/(massPre40||1);const p=solvePForTruncMean(targetMeanPre40,K);const pre40=truncatedGeomWeights(p,K);for(let i=0;i<pre40.length;i++)pre40[i]*=massPre40;const pmf=new Float64Array(maxAge+1);for(let a=0;a<=K&&a<=maxAge;a++)pmf[a]=pre40[a]||0;if(40<=maxAge)pmf[40]+=pmf40;pmf[maxAge]+=pmfMax;let sumP=0;for(let i=0;i<pmf.length;i++)sumP+=pmf[i];for(let i=0;i<pmf.length;i++)pmf[i]/=sumP;const S=new Float64Array(maxAge+2);S[0]=1;for(let a=0;a<=maxAge;a++)S[a+1]=S[a]-pmf[a];const q=new Float64Array(maxAge+1);for(let a=0;a<=maxAge;a++)q[a]=S[a]>0?pmf[a]/S[a]:0;q[maxAge]=1;let mean=0;for(let a=0;a<=maxAge;a++)mean+=pmf[a]*a;return{pmf,S,q,mean,S40check:S[40]||0,Smaxcheck:S[maxAge]||0}}

function simulate(p){const{startPop,startMeanAge,meanLife,survive40Denom,surviveMaxDenom,maxAge,fertileStart,fertileEnd,kidsPerGirl,years,catEnabled,catPeriod,catKillPct,catStart}=p;const S40=1/survive40Denom,Smax=1/surviveMaxDenom;const life=buildLifeTable(meanLife,S40,Smax,maxAge),q=life.q;const span=Math.max(1,Math.min(maxAge,Math.round(2*startMeanAge)));const ageCounts=new Float64Array(maxAge+1),survivors=new Float64Array(maxAge+1);for(let a=0;a<=span;a++)ageCounts[a]=startPop/(span+1);const fertYears=Math.max(1,fertileEnd-fertileStart+1),fertRate=kidsPerGirl/fertYears;const sampleEvery=Math.max(1,Math.floor(years/1200));const data=[];let birthsCum=0,deathsCum=0;for(let t=0;t<=years;t++){let total=0,fertile=0;for(let a=0;a<=maxAge;a++){const c=ageCounts[a];total+=c;if(a>=fertileStart&&a<=fertileEnd)fertile+=c}const births=0.5*fertRate*fertile;let deaths=0;for(let a=0;a<=maxAge;a++){const c=ageCounts[a];const d=c*q[a];const s=c-d;survivors[a]=s;deaths+=d}for(let a=maxAge;a>=1;a--)ageCounts[a]=survivors[a-1];ageCounts[0]=births;let catDeaths=0;if(catEnabled&&catPeriod>0&&t>=catStart&&t%catPeriod===0&&t>0){let nextTotal=0;for(let a=0;a<=maxAge;a++)nextTotal+=ageCounts[a];const killFrac=Math.max(0,Math.min(1,catKillPct/100));catDeaths=nextTotal*killFrac;if(catDeaths>0){const scale=1-killFrac;for(let a=0;a<=maxAge;a++)ageCounts[a]*=scale}}birthsCum+=births;deathsCum+=deaths+catDeaths;if(t%sampleEvery===0)data.push({t,pop:total,births,deaths:deaths+catDeaths,birthsCum,deathsCum})}return{data,life}}

function drawChart(canvas,data,years,log,yMaxPos,cross){const dpr=window.devicePixelRatio||1;const rect=canvas.getBoundingClientRect();canvas.width=rect.width*dpr;canvas.height=rect.height*dpr;const ctx=canvas.getContext('2d');ctx.setTransform(dpr,0,0,dpr,0,0);const m={l:64,r:16,t:12,b:28};const W=rect.width,H=rect.height,w=W-m.l-m.r,h=H-m.t-m.b;ctx.clearRect(0,0,W,H);const x0=0,x1=years;const yMinLinear=-100000,yMaxLinear=yMaxPos,yMaxLog=yMaxPos;const xToPx=x=>m.l+((x-x0)/(x1-x0))*w;const yToPxLinear=y=>m.t+(1-(y-yMinLinear)/(yMaxLinear-yMinLinear))*h;const yToPxLog=y=>{const yy=Math.max(1,y);const t=(Math.log10(yy)-0)/(Math.log10(yMaxLog)-0);return m.t+(1-t)*h};const yToPx=log?yToPxLog:yToPxLinear;ctx.strokeStyle='#1f2937';ctx.lineWidth=1;for(let i=0;i<=10;i++){const x=x0+i/10*(x1-x0);const px=xToPx(x);ctx.beginPath();ctx.moveTo(px,m.t);ctx.lineTo(px,m.t+h);ctx.stroke()}if(!log){[-100000,-50000,0,yMaxLinear/2,yMaxLinear].forEach(y=>{const py=yToPx(y);ctx.beginPath();ctx.moveTo(m.l,py);ctx.lineTo(m.l+w,py);ctx.stroke()})}else{[1,10,100,1000,10000,yMaxLog].forEach(y=>{const py=yToPx(y);ctx.beginPath();ctx.moveTo(m.l,py);ctx.lineTo(m.l+w,py);ctx.stroke()})}ctx.fillStyle='#94a3b8';ctx.font='12px system-ui,Segoe UI,Roboto,Helvetica,Arial';ctx.textAlign='center';for(let i=0;i<=10;i++){const x=x0+i/10*(x1-x0);const px=xToPx(x);ctx.fillText(String(Math.round(x)),px,H-8)}ctx.textAlign='right';const yLabels=log?[1,10,100,1000,10000,yMaxLog]:[-100000,0,yMaxLinear];yLabels.forEach(y=>{const py=yToPx(y);const label=y===0?'0':(y<0?'-'+abbr(Math.abs(y)):abbr(y));ctx.fillText(label,m.l-6,py+4)});ctx.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue('--pink')||'#ec4899';ctx.lineWidth=2.5;ctx.beginPath();for(let i=0;i<data.length;i++){const pt=data[i];const x=xToPx(pt.t),y=yToPx(pt.pop);if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y)}ctx.stroke();if(cross){const{t,pop}=cross;const cx=xToPx(t),cy=yToPx(pop);ctx.strokeStyle='#94a3b8';ctx.lineWidth=1;ctx.setLineDash([2,2]);ctx.beginPath();ctx.moveTo(cx,m.t);ctx.lineTo(cx,m.t+h);ctx.stroke();ctx.setLineDash([]);ctx.fillStyle='#ec4899';ctx.beginPath();ctx.arc(cx,cy,3,0,Math.PI*2);ctx.fill()}return{xToPx,yToPx,x0,x1}}

function byId(id){return document.getElementById(id)}
const els={startPop:byId('startPop'),startMeanAge:byId('startMeanAge'),years:byId('years'),yearsRange:byId('yearsRange'),logScale:byId('logScale'),meanLife:byId('meanLife'),maxAge:byId('maxAge'),survive40Denom:byId('survive40Denom'),surviveMaxDenom:byId('surviveMaxDenom'),fertileStart:byId('fertileStart'),fertileEnd:byId('fertileEnd'),kidsPerGirl:byId('kidsPerGirl'),fertYears:byId('fertYears'),birthsPerYear:byId('birthsPerYear'),catEnabled:byId('catEnabled'),catPeriod:byId('catPeriod'),catKillPct:byId('catKillPct'),catStart:byId('catStart'),startYearBig:byId('startYearBig'),healthLabel:byId('healthLabel'),healthDetail:byId('healthDetail'),chart:byId('chart'),tooltip:byId('tooltip'),resetBtn:byId('resetBtn'),yMaxSelect:byId('yMaxSelect')};

const DEFAULTS={startPop:400,startMeanAge:10,years:100000,logScale:false,meanLife:10,maxAge:80,survive40Denom:180,surviveMaxDenom:1000,fertileStart:9,fertileEnd:35,kidsPerGirl:12.2,catEnabled:false,catPeriod:200,catKillPct:70,catStart:200};
function setDefaults(){for(const[k,v]of Object.entries(DEFAULTS)){const el=els[k];if(!el)continue;if(el.type==='checkbox')el.checked=!!v;else el.value=String(v)}els.yearsRange.value=String(DEFAULTS.years);els.yMaxSelect.value='100000'}

function paramsFromUI(){const fp=parseFloat(els.fertileStart.value)||0;const fe=parseFloat(els.fertileEnd.value)||0;const fertYears=Math.max(1,fe-fp+1);els.fertYears.textContent=String(fertYears);const kpg=parseFloat(els.kidsPerGirl.value)||0;els.birthsPerYear.textContent=(kpg/fertYears).toFixed(3);const s40d=parseFloat(els.survive40Denom.value)||1;const smaxd=parseFloat(els.surviveMaxDenom.value)||1;byId('s40Pct').textContent=(100/s40d).toFixed(3);byId('smaxPct').textContent=(100/smaxd).toFixed(3);byId('checkMaxAge').textContent=els.maxAge.value;const{yrsAgo,preHuman}=interpYearsAgoFromAge(fp);const label=preHuman?'PRE‑HUMAN':formatYearFromYearsAgo(yrsAgo);els.startYearBig.textContent=label;els.startYearBig.className='bigyear'+(preHuman?' prehuman':'');const yMaxPos=parseInt(els.yMaxSelect.value)||100000;return{startPop:parseFloat(els.startPop.value)||0,startMeanAge:parseFloat(els.startMeanAge.value)||0,meanLife:parseFloat(els.meanLife.value)||0,survive40Denom:s40d,surviveMaxDenom:smaxd,maxAge:parseInt(els.maxAge.value)||0,fertileStart:parseInt(els.fertileStart.value)||0,fertileEnd:parseInt(els.fertileEnd.value)||0,kidsPerGirl:kpg,years:parseInt(els.years.value)||0,logScale:!!els.logScale.checked,catEnabled:!!els.catEnabled.checked,catPeriod:parseInt(els.catPeriod.value)||0,catKillPct:parseFloat(els.catKillPct.value)||0,catStart:parseInt(els.catStart.value)||0,yMaxPos:yMaxPos}}

function computeHealth(p){const params=Object.assign({},p,{years:10000});const{data}=simulate(params);const last=data[data.length-1]||{pop:0};const pop=Math.max(0,Math.round(last.pop));const start=Math.max(1,Math.round(p.startPop));const mult=pop/start;let label='—',cls='';if(pop<2){label='Population death';cls='health-dead'}else if(pop<=100000){label='Healthy';cls='health-ok'}else if(pop<=1000000){label='Medium';cls='health-med'}else if(pop<1000000000000){label='Caution';cls='health-caution'}else{label='Warning';cls='health-warn'}return{pop,mult,label,cls}}

let cached={data:[],years:0,log:false,yMax:100000};
function run(){const p=paramsFromUI();const{data,life}=simulate(p);drawChart(els.chart,data,p.years,p.logScale,p.yMaxPos);byId('checkS40').textContent=(life.S40check*100).toFixed(3);byId('checkSMax').textContent=(life.Smaxcheck*100).toFixed(3);byId('checkMean').textContent=life.mean.toFixed(3);const h=computeHealth(p);els.healthLabel.textContent=h.label;els.healthLabel.className='health '+h.cls;els.healthDetail.textContent=`Projected in 10,000 years: ${h.pop.toLocaleString()} (×${h.mult.toFixed(2)})`;cached={data,years:p.years,log:p.logScale,yMax:p.yMaxPos}}

(function setupHover(){const canvas=els.chart,tip=els.tooltip;function nearestPoint(t){const arr=cached.data;if(!arr.length)return null;let lo=0,hi=arr.length-1;while(hi-lo>1){const mid=(lo+hi)>>1;if(arr[mid].t<t)lo=mid;else hi=mid}const a=arr[lo],b=arr[Math.min(hi,arr.length-1)];return Math.abs(a.t-t)<Math.abs(b.t-t)?a:b}function move(ev){const rect=canvas.getBoundingClientRect();const x=ev.clientX-rect.left;const m={l:64,r:16,t:12,b:28};const w=rect.width-m.l-m.r;if(w<=0)return;const t=Math.max(0,Math.min(cached.years,((x-m.l)/w)*(cached.years)));const pt=nearestPoint(t);if(!pt){tip.style.display='none';return}drawChart(canvas,cached.data,cached.years,cached.log,cached.yMax,{t:pt.t,pop:pt.pop});tip.style.display='block';tip.textContent=`Year ${Math.round(pt.t)} — Pop ${Math.round(pt.pop).toLocaleString()} · B ${Math.round(pt.births).toLocaleString()} (Σ ${Math.round(pt.birthsCum).toLocaleString()}) · D ${Math.round(pt.deaths).toLocaleString()} (Σ ${Math.round(pt.deathsCum).toLocaleString()})`;let tx=x+10,ty=ev.clientY-rect.top-10;if(tx>rect.width-260)tx=rect.width-260;if(ty<20)ty=20;tip.style.left=tx+'px';tip.style.top=ty+'px'}function leave(){tip.style.display='none';drawChart(canvas,cached.data,cached.years,cached.log,cached.yMax,null)}canvas.addEventListener('mousemove',move,{passive:true});canvas.addEventListener('mouseleave',leave,{passive:true})})();

let to=null;function onChange(){clearTimeout(to);to=setTimeout(()=>{window.requestAnimationFrame(run)},DEBOUNCE_MS)}
['startPop','startMeanAge','years','yearsRange','logScale','meanLife','maxAge','survive40Denom','surviveMaxDenom','fertileStart','fertileEnd','kidsPerGirl','catEnabled','catPeriod','catKillPct','catStart','yMaxSelect'].forEach(id=>{const el=els[id];if(!el)return;el.addEventListener(el.type==='checkbox'?'change':'input',onChange)});
els.years.addEventListener('input',()=>{els.yearsRange.value=String(els.years.value)});
els.yearsRange.addEventListener('input',()=>{els.years.value=String(els.yearsRange.value)});
els.resetBtn.addEventListener('click',()=>{setDefaults();run()});window.addEventListener('resize',()=>{window.requestAnimationFrame(run)});

setDefaults();run();
</script>
</body>
</html>
